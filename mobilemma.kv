#:kivy 1.4.0
#:import MMALexer mmalexer.MMALexer

<MobileMMAUI>:
    # ids as properties so that they can be used in python code
    buttons_key: buttons_key
    groove_tree: groove_tree
    tune_list: tune_list

    BoxLayout:
        orientation: "vertical"
        size: root.size
        pos: root.pos

        Accordion:
            AccordionItem:
                title: "Key"

                BoxLayout:
                    orientation: "vertical"

                    BoxLayout:
                        orientation: "horizontal"
                        size_hint_y: None
                        height: 40

                        Button:
                            text: "All"
                            on_press:
                                for note in buttons_key.children: note.state = 'down'

                        Button:
                            text: "None"
                            on_press:
                                for note in buttons_key.children: note.state = 'normal'

                    GridLayout:
                        id: buttons_key
                        cols: 4
                        # b musical symbol : â™­ = \u266D

                        ToggleButton:
                            text: "C"
                            state: 'down'

                        ToggleButton:
                            text: u"C# / Db"
                            state: 'down'

                        ToggleButton:
                            text: "D"
                            state: 'down'

                        ToggleButton:
                            text: "D# / Eb"
                            state: 'down'

                        ToggleButton:
                            text: "E"
                            state: 'down'

                        ToggleButton:
                            text: "F"
                            state: 'down'

                        ToggleButton:
                            text: "F# / Gb"
                            state: 'down'

                        ToggleButton:
                            text: "G"
                            state: 'down'

                        ToggleButton:
                            text: "G# / Ab"
                            state: 'down'

                        ToggleButton:
                            text: "A"
                            state: 'down'

                        ToggleButton:
                            text: "A# / Bb"
                            state: 'down'

                        ToggleButton:
                            text: "B"
                            state: 'down'

            AccordionItem:
                title: "Groove"

                BoxLayout:
                    orientation: "vertical"

                    BoxLayout:
                        orientation: "horizontal"
                        size_hint_y: None
                        height: 40

                        Button:
                            text: "All"
                            on_press:
                                for groove in groove_tree.children: groove.state = 'down'

                        Button:
                            text: "None"
                            on_press:
                                for groove in groove_tree.children: groove.state = 'normal'

                    ScrollView:
                        do_scroll_x: False
                        scroll_timeout: 250
                        scroll_distance: 5

                        TreeView:
                            id: groove_tree
                            size_hint_y: None
                            height: self.minimum_height
                            hide_root: True
                            indent_level: 32
                            indent_start: 32


            AccordionItem:
                title: "Additional filters"

                BoxLayout:
                    orientation: "vertical"

            AccordionItem:
                title: "Options"

                BoxLayout:
                    orientation: "vertical"

        ListView:
            id: tune_list

        BoxLayout:
            orientation: "horizontal"
            size_hint_y: None
            height: 40

            Button:
                text: "Play"
                on_release: root.play_pause(file_chooser.selection and file_chooser.selection[0] or "")

            Button:
                text: "Stop"
                on_release: root.stop()

            Button:
                text: "Edit"

            Button:
                text: "Configuration"
                on_release:

<TreeViewToggleButton>:
    padding: 14, 10
    height: self.texture_size[1] + self.padding_y * 2
    text_size: self.width - self.padding_x * 2, None
    no_selection: True
    state: 'down'
    on_state: for child in self.nodes: child.state = self.state
